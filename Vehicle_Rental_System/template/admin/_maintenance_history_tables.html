<ul class="nav nav-tabs" id="maintenanceHistoryTabs" role="tablist">
    <li class="nav-item">
        <a class="nav-link active" id="records-tab" data-toggle="tab" href="#records" role="tab" aria-controls="records" aria-selected="true">Core Records</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="details-tab" data-toggle="tab" href="#details" role="tab" aria-controls="details" aria-selected="false">Operational Details</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="costs-tab" data-toggle="tab" href="#costs" role="tab" aria-controls="costs" aria-selected="false">Costs & Scheduling (View)</a>
    </li>
</ul>

<div class="tab-content" id="maintenanceHistoryTabsContent">
    <!-- Core Records Table -->
    <div class="tab-pane fade show active" id="records" role="tabpanel" aria-labelledby="records-tab">
        <h4 class="mt-3">Core Maintenance Records</h4>
        <p class="text-muted">A complete history of all maintenance activities.</p>
        <div class="table-responsive">
            <table class="table table-sm table-bordered">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Vehicle</th>
                        <th>Date</th>
                        <th>Type</th>
                        <th>Description</th>
                        <th>Provider</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for record in maintenance_records %}
                    <tr>
                        <td>{{ record.id }}</td>
                        <td>{{ record.vehicle.vehicle_number }}</td>
                        <td>{{ record.maintenance_date|date:"Y-m-d" }}</td>
                        <td>{{ record.get_maintenance_type_display }}</td>
                        <td>{{ record.description }}</td>
                        <td>{{ record.service_provider }}</td>
                        <td>{{ record.status }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Operational Details Table -->
    <div class="tab-pane fade" id="details" role="tabpanel" aria-labelledby="details-tab">
        <h4 class="mt-3">Operational Details</h4>
        <p class="text-muted">Detailed information entered by technicians.</p>
        <div class="table-responsive">
            <table class="table table-sm table-bordered">
                <thead>
                    <tr>
                        <th>Maint. ID</th>
                        <th>Vehicle</th>
                        <th>Mileage</th>
                        <th>Parts Replaced</th>
                        <th>Cost (₹)</th>
                        <th>Technician</th>
                    </tr>
                </thead>
                <tbody>
                    {% for detail in details_records %}
                    <tr>
                        <td>{{ detail.maintenance_record_id }}</td>
                        <td>{{ detail.maintenance_record.vehicle.vehicle_number }}</td>
                        <td>{{ detail.mileage_at_service }}</td>
                        <td>{{ detail.parts_replaced }}</td>
                        <td>{{ detail.cost }}</td>
                        <td>{{ detail.technician_name }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Costs Table -->
    <div class="tab-pane fade" id="costs" role="tabpanel" aria-labelledby="costs-tab">
        <h4 class="mt-3">Costs & Scheduling</h4>
        <p class="text-muted">Financial data and future service dates.</p>
        <div class="table-responsive">
            <table class="table table-sm table-bordered">
                <thead>
                    <tr>
                        <th>Maint. ID</th>
                        <th>Vehicle</th>
                        <th>Date</th>
                        <th>Cost (₹)</th>
                        <th>Next Service</th>
                    </tr>
                </thead>
                <tbody>
                    {% for record in maintenance_records %}
                    <tr>
                        <td>{{ record.id }}</td>
                        <td>{{ record.vehicle.vehicle_number }}</td>
                        <td>{{ record.maintenance_date|date:"Y-m-d" }}</td>
                        <td>{{ record.costs.cost|default_if_none:"N/A" }}</td>
                        <td>{{ record.costs.next_service_date|date:"Y-m-d"|default_if_none:"N/A" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>